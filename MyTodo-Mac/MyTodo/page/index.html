<!doctype html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport"
        content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>MyTodo</title>

    <script src="./sober.min.js"></script>
    <script src="./ui.js"></script>
    <script src="./bridge.js"></script>
    <script>
        var tabCount = 0
        function tabSelect(index) {
            if (index == tabCount - 1) {
                setVisibility("dataTableContainer", false);
                setVisibility("newTabPage", true);
            } else {
                setVisibility("dataTableContainer", true);
                setVisibility("newTabPage", false);
            }
        }
    </script>

    <style>
        html,
        body {
            height: 100%;
            /** 高度填充视图 **/
            overflow: hidden;
            /** 禁用滚动 **/
            margin: 0;
            /** 消除body外间距 **/
            -webkit-tap-highlight-color: transparent;
            /** 消除移动端默认tap反馈 **/
        }

        :not(:defined) {
            /** Web Components 未准备完毕时隐藏 **/
            display: none;
        }
    </style>
</head>

<body>
    <s-page id="app">
        <s-tab id="headerTabs" onchange="tabSelect(this.selectIndex)" style="justify-content: flex-start">
        </s-tab>

        <div style="height: 296px;">
            <s-scroll-view id="dataTableContainer" style="width: 100%; height: 100%;">
                <image style="width: 100%;"
                    src="https://images.unsplash.com/photo-1715596828741-3e2aa6bc3aff?q=80&w=1287&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D">
            </s-scroll-view>
            </s-scroll-view>
            <div id="newTabPage"
                style="display: none; width: 100%; height: 100%; color: blue; justify-content: center; align-items: center;">
                <s-icon-button>
                    <s-icon type="search"></s-icon>
                </s-icon-button>
                <s-text-field label="请输入名称">
                    <input id="newTabInput" type="text">
                    <s-icon-button id="newTabCommitBtn" slot="end">
                        <s-icon slot="end">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
                                <path d="M360-240 120-480l240-240 56 56-144 144h488v-160h80v240H272l144 144-56 56Z"></path>
                            </svg>
                        </s-icon>
                    </s-icon-button>
                </s-text-field>
            </div>
        </div>


        <s-text-field id="editor" style="display: block; width: 100%; position:absolute; bottom: 0;">
            <input type="text" placeholder="请输入名称">
            <s-icon slot="end" type="done"></s-icon>
        </s-text-field>

    </s-page>
    <script>
        tabCount = header()
        
        // 获取输入框元素
        var input = document.getElementById("newTabInput");

        // 绑定 keydown 事件监听器
        input.addEventListener("keydown", function(event) {
            // 如果按下的是回车键
            if (event.keyCode === 13) {
                var textContent = input.value;
                // 执行你想要的操作，比如提交表单、搜索等
                console.log("enter ", textContent);
            }
        });

        var newTabCommitBtn = document.getElementById("newTabCommitBtn");
        newTabCommitBtn.addEventListener("click", function(event) {
            var textContent = input.value;
            console.log("click ...", textContent);
        })
    </script>
</body>

</html>